const fetch = require("node-fetch");

module.exports = async (req, res) => {
    // Ottieni il parametro dalla query string
    const { component_name } = req.query;

    // Verifica se il parametro è presente
    if (!component_name) {
        return res.status(400).json({ error: "Parametro 'component_name' mancante" });
    }

    // URL base di Designers Italia
    const BASE_URL = "https://designers.italia.it/design-system/componenti";
    const componentUrl = `${BASE_URL}/${component_name}`;

    try {
        // Recupera i dati dal sito di Designers Italia
        const response = await fetch(componentUrl);

        // Se il componente non esiste
        if (response.status === 404) {
            return res.status(404).json({ error: "Componente non trovato" });
        }

        // Creazione dei dati da restituire
        const previewImage = `${BASE_URL}/assets/anteprima-${component_name}.png`;
        return res.status(200).json({
            name: component_name,
            description: `Questo è il componente ${component_name} dal Design System di Designers Italia.`,
            previewImage,
            livePreview: componentUrl,
        });
    } catch (error) {
        console.error(error);
        return res.status(500).json({ error: "Errore interno del server" });
    }
};
